<?xml version="1.0" encoding="utf-8"?>
<!-- Copyright 2023 Manuel Regidor <manuel.regidor@sygel.es>
 License AGPL-3.0 or later (https://www.gnu.org/licenses/agpl). -->
<odoo>
    <template id="project_task_sign_timesheet_table" inherit_id="hr_timesheet.timesheet_table">
        <xpath expr="div[hasclass('mt8')]" position="after">
            <div t-if="len(lines.task_id) == 1">
                <t t-set="material_lines" t-value="lines.task_id.move_ids.filtered(lambda a: a.quantity_done > 0.0)"/>
                <t t-if="material_lines">
                    <div class="row mt8">
                        <div class="col-12">
                            <h2>
                                <br/>
                                <span>Materials</span>
                            </h2>
                            <table class="table table-sm">
                                <thead>
                                  <tr>
                                    <th style="text-align: left">Name</th>
                                    <th class="text-end">Quantity</th>
                                  </tr>
                                </thead>
                                <tr t-foreach="material_lines" t-as="m">
                                    <td><t t-esc="m.product_id.name"/></td>
                                    <td class="text-end"><t t-esc="m.product_uom_qty"/> <t t-esc="m.product_uom.name"/></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </t>
                <t t-if="lines.task_id.signed">     
                    <div class="row mt8" align="right" t-if="lines.task_id.signature_img">
                        <div class="col-12">
                            <img t-att-src="image_data_uri(lines.task_id.signature_img)" style="width: 320px;"/>
                        </div>
                    </div>
                    <div class="row mt8" align="right" t-if="lines.task_id.signature_name">
                        <div class="col-12">
                            <p t-esc="lines.task_id.signature_name"/>
                        </div>
                    </div>
                    <div class="row mt8" align="right" t-if="lines.task_id.signature_date">
                        <div class="col-12">
                            <p t-field="lines.task_id.signature_date" t-options="{'widget': 'datetime', 'format': 'dd/MM/YYYY - hh:mm'}"/>
                        </div>
                    </div>
                </t>
            </div>
        </xpath>
    </template>
</odoo>
